container: "docker://continuumio/miniconda3:4.4.10"


rule run_metaspades:
    input:
        reads=["test_reads/sample1_R1.fastq.gz", "test_reads/ample1_R2.fastq.gz"],
    output:
        "assembly/contigs.fasta",
        "assembly/scaffolds.fasta",
    benchmark:
        "logs/benchmarks/assembly/spades.txt"
    params:
        # all parameters are optional
        output_dir="assembly/intermediate_files",
        k="auto",
        extra="--only-assembler",
    log:
        "log/spades.log",  #stdout/stderr is written in first log file
        "assembly/intermediate_files/spades.log",  #spades creates anyway a this log file
    threads: 8
    resources:
        mem_mem=250000,
        time=60 * 24,
    wrapper:
        "master/bio/bwa/aln"


rule download_reads:
    output:
        ["test_reads/sample1_R1.fastq.gz", "test_reads/ample1_R2.fastq.gz"],
    log:
        "log/download.log",
    shell:
        " wget https://zenodo.org/record/3992790/files/test_reads.tar.gz >> {log} 2>&1"
        " tar -xzf test_reads.tar.gz >> {log} 2>&1"
