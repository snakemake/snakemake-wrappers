name: mapDamage2
description: mapDamage2 is a computational framework written in Python and R, which tracks and quantifies DNA damage patterns among ancient DNA sequencing reads generated by Next-Generation Sequencing platforms.
url: https://ginolhac.github.io/mapDamage/
authors:
  - Filipe G. Vieira
input:
  - reference genome
  - SAM/BAM/CRAM alignemnt
output:
  - log: log file with a summary of command lines used and timestamps.
  # Plotting
  - misinc: table with occurrences for each type of mutations and relative positions from the reads ends.
  - CtoT5p: frequencies of Cytosine to Thymine mutations per position from the 5'-ends.
  - GtoA3p: frequencies of Guanine to Adenine mutations per position from the 3'-ends.
  - dnacomp: table of the reference genome base composition per position, inside reads and adjacent regions.
  - lg_dist: table with read length distributions per strand.
  - plot_misinc: pdf file that displays both fragmentation and misincorporation patterns.
  - plot_len: pdf file that displays length distribution of singleton reads per strand and cumulative frequencies of C->T at 5'-end and G->A at 3'-end are also displayed per strand.
  # Stats output
  - stats_hist: MCMC histogram for the damage parameters and log likelihood.
  - stats_iter: damage parameters and log likelihood in each MCMC iteration.
  - stats_summ: summary statistics for the damage parameters estimated posterior distributions.
  - stats_prob: position specific probability of a C->T and G->A misincorporation is due to damage.
  - stats_ref: global reference genome base composition (computed by seqtk).
  - stats_plot_trace: MCMC trace plot for the damage parameters and log likelihood.
  - stats_plot_freq: empirical misincorporation frequency and posterior predictive intervals from the fitted model.
  # Rescaled BAM output
  - bam: rescaled BAM file, where likely post-mortem damaged bases have downscaled quality scores.
params:
  - extra: additional program arguments.
notes: |
  * All output files can also be used as input, when using existing results.
  * All output files are optional.
  * Optional output flags (`--plots-only`, `--stats-only`, `--rescale-only`, and `--no-stats`) are automatically inferred.
